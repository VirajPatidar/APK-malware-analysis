import React from 'react';
import { withStyles } from '@material-ui/core/styles';
import MuiAccordion from '@material-ui/core/Accordion';
import MuiAccordionSummary from '@material-ui/core/AccordionSummary';
import MuiAccordionDetails from '@material-ui/core/AccordionDetails';
import Typography from '@material-ui/core/Typography';

const Accordion = withStyles({
  root: {
    border: '1px solid rgba(0, 0, 0, .125)',
    boxShadow: 'none',
    '&:not(:last-child)': {
      borderBottom: 0,
    },
    '&:before': {
      display: 'none',
    },
    '&$expanded': {
      margin: 'auto',
    },
  },
  expanded: {},
})(MuiAccordion);

const AccordionSummary = withStyles({
  root: {
    backgroundColor: 'rgba(0, 0, 0, .03)',
    borderBottom: '1px solid rgba(0, 0, 0, .125)',
    marginBottom: -1,
    minHeight: 56,
    '&$expanded': {
      minHeight: 56,
    },
  },
  content: {
    '&$expanded': {
      margin: '12px 0',
    },
  },
  expanded: {},
})(MuiAccordionSummary);

const AccordionDetails = withStyles((theme) => ({
  root: {
    padding: theme.spacing(2),
  },
}))(MuiAccordionDetails);

export default function CustomizedAccordions() {
  const [expanded, setExpanded] = React.useState('panel1');

  const handleChange = (panel) => (event, newExpanded) => {
    setExpanded(newExpanded ? panel : false);
  };

  return (
    <div>
      <Accordion square expanded={expanded === 'panel1'} onChange={handleChange('panel1')}>
        <AccordionSummary aria-controls="panel1d-content" id="panel1d-header">
          <Typography>LEVEL 1 - Malicious Package Detection</Typography>
        </AccordionSummary>
        <AccordionDetails>
          <Typography>
            The first level of analysis is the detection of malicious package. The extracted package
            is compared to a list of malicious packages from our dataset. If the extracted package 
            occurs in the list, the APK file is declared as malicious. 
          </Typography>
        </AccordionDetails>
      </Accordion>
      <Accordion square expanded={expanded === 'panel2'} onChange={handleChange('panel2')}>
        <AccordionSummary aria-controls="panel2d-content" id="panel2d-header">
          <Typography>LEVEL 2 - Malicious Permissions Detection</Typography>
        </AccordionSummary>
        <AccordionDetails>
          <Typography>
            The second level of analysis is the detection of malicious permissions. The extracted permissions
            are compared to a list of malicious permissions from our dataset. These permissions grant the 
            application admin privileges. The APK file is declared as malicious if atleast one of the extracted 
            permissions occur in the dataset list.
          </Typography>
        </AccordionDetails>
      </Accordion>
      <Accordion square expanded={expanded === 'panel3'} onChange={handleChange('panel3')}>
        <AccordionSummary aria-controls="panel3d-content" id="panel3d-header">
          <Typography>LEVEL 3 - Suspicious Combination of Permissions</Typography>
        </AccordionSummary>
        <AccordionDetails>
          <Typography>
            The third level of analysis is the detection of suspicious combination of permissions. The extracted 
            permissions are compared to a list of combinations of permissions from our dataset. If atleast one of 
            the combination from dataset is a subset of the extracted permissions, the APK file is declared as malicious.
          </Typography>
        </AccordionDetails>
      </Accordion>
    </div>
  );
}
